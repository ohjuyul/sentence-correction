root@986d73f0cf4d:/workspace/sentence/src# python3 check.py
Using device: cuda
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
{'input_ids': tensor([[    2,  8614,  8097,  ...,     0,     0,     0],
        [    2,  8762,  8295,  ...,     0,     0,     0],
        [    2,  1652,  4777,  ...,     0,     0,     0],
        ...,
        [    2, 14808,  4050,  ...,     0,     0,     0],
        [    2, 10508,  4012,  ...,     0,     0,     0],
        [    2,  2548,   654,  ...,     0,     0,     0]], device='cuda:0'), 'attention_mask': tensor([[1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0]], device='cuda:0'), 'labels': tensor([[    2,  8614,  2769,  ...,  -100,  -100,  -100],
        [    2,  8762,  3354,  ...,  -100,  -100,  -100],
        [    2,  1652,  4777,  ...,  -100,  -100,  -100],
        ...,
        [    2, 14808,  4050,  ...,  -100,  -100,  -100],
        [    2, 10508,   291,  ...,  -100,  -100,  -100],
        [    2,  2548,   654,  ...,  -100,  -100,  -100]], device='cuda:0'), 'decoder_input_ids': tensor([[    2,  8614,  8097,  ...,     0,     0,     0],
        [    2,  8762,  8295,  ...,     0,     0,     0],
        [    2,  1652,  4777,  ...,     0,     0,     0],
        ...,
        [    2, 14808,  4050,  ...,     0,     0,     0],
        [    2, 10508,  4012,  ...,     0,     0,     0],
        [    2,  2548,   654,  ...,     0,     0,     0]], device='cuda:0')}
Traceback (most recent call last):
  File "/workspace/sentence/src/check.py", line 56, in <module>
    assert batch["decoder_input_ids"][:, 0].eq(model.dec_tok.bos_token_id).all()  # BOS token 확인
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError
